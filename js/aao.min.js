function render(){console.log("render")}var AAO={};AAO.Boot=function(e){console.debug("Boot()")};AAO.Boot.prototype.preload=function(){console.debug("Boot.preload()");this.load.image("loading","img/loading.png");this.load.image("loading-bar","img/loading-bar.png")};AAO.Boot.prototype.create=function(){console.debug("Boot.create()");this.input.maxPointers=1;this.state.start("Preloader")};AAO.Preloader=function(e){console.debug("Preloader()");AAO.GAME_WIDTH=1280;AAO.GAME_HEIGHT=720;this.loadiongBarCache_=null;this.loadingBar_=null};AAO.Preloader.prototype.preload=function(){console.debug("Preloader.preload()");this.stage.backgroundColor="#000";this.game.add.sprite(0,0,"loading");this.loadiongBarCache_=this.game.cache.getImage("loading-bar");this.loadingBar_=this.game.add.sprite(270,363,"loading-bar");this.loadingBar_.crop(new Phaser.Rectangle(0,0,0,this.loadingBar_.height));this.load.image("bullet","img/bullet.png");this.load.spritesheet("player","img/player.png",50,95,2);this.load.image("player-shoot","img/player-shoot.png");this.load.spritesheet("zombie","img/zombie.png",128,128,24);this.load.image("background","img/background.jpg");this.load.image("darkness","img/darkness.png");this.load.image("darkness-alpha-mask","img/darkness-alpha-mask.png");this.load.image("game-over-overlay","img/game-over-overlay.png");this.load.image("menu-background","img/menu-bg.jpg");this.load.image("clip-empty","img/clip-empty.png");this.load.image("clip-loaded","img/clip-loaded.png");this.load.image("smoke","img/smoke.png");this.load.image("smoke-test","img/smoke-test.png");this.load.spritesheet("clip-sprite","img/clip-sprite.png",71,37,2);this.game.load.script("filter","filters/Pixelate.js");this.game.load.audio("menu-background",["sound/music/menu-background.mp3","sound/music/menu-background.ogg"],true);this.game.load.audio("gameplay-background",["sound/music/gameplay-background.mp3","sound/music/gameplay-background.ogg"],true);this.game.load.audio("zombie-shuffle",["sound/sfx/zombie_shuffle.mp3","sound/sfx/zombie_shuffle.ogg"],true);this.game.load.audio("gunshot",["sound/sfx/gunshot.mp3","sound/sfx/gunshot.ogg"]);this.game.load.audio("gunshot-empty",["sound/sfx/gunshot-empty.mp3","sound/sfx/gunshot-empty.ogg"]);this.game.load.audio("gunshot-hit",["sound/sfx/gunshot-hit.mp3","sound/sfx/gunshot-hit.ogg"]);this.game.load.audio("slow-down-to-halt",["sound/sfx/slow_down_to_halt.mp3","sound/sfx/slow_down_to_halt.ogg"]);this.game.load.audio("rewind",["sound/sfx/rewind.mp3","sound/sfx/rewind.ogg"]);this.game.load.audio("rewind",["sound/sfx/rewind.mp3","sound/sfx/rewind.ogg"]);this.game.load.audio("select",["sound/sfx/radio.mp3","sound/sfx/radio.ogg"]);this.game.load.audio("reload",["sound/sfx/reload-fast.mp3","sound/sfx/reload-fast.ogg"]);this.game.load.audio("zombie-groan",["sound/sfx/zombie_groan.mp3","sound/sfx/zombie_groan.ogg"]);this.game.load.spritesheet("start-button","img/menu-start-button.png",305,97);this.game.load.spritesheet("restart-button","img/game-over-restart-button.png",253,97);this.load.bitmapFont("juice-regular","fonts/juice-regular.png","fonts/juice-regular.xml");this.load.onFileComplete.add(this.onFileComplete_.bind(this))};AAO.Preloader.prototype.create=function(){console.debug("Preloader.create()");var e=setInterval(function(){var t=0;t+=this.cache.isSoundReady("menu-background")*.3;t+=this.cache.isSoundReady("gameplay-background")*.3;t+=this.cache.isSoundReady("zombie-shuffle")*.4;var n=this.loadiongBarCache_.width-this.loadingBar_.width;var r=n*t;this.loadingBar_.crop(new Phaser.Rectangle(0,0,this.loadingBar_.width+r,this.loadingBar_.height));if(t===1){clearInterval(e);document.body.classList.add("ready");this.state.start("MainMenu")}}.bind(this),1e3)};AAO.Preloader.prototype.onFileComplete_=function(e){console.debug("Preloader.onFileComplete_()");this.loadingBar_.crop(new Phaser.Rectangle(0,0,this.loadiongBarCache_.width*(e/140),this.loadiongBarCache_.height))};AAO.MainMenu=function(e){this.menuMusic_=null;this.clouds_=[];this.CLOUD_ANIMATION_SPEED=25e3};AAO.MainMenu.prototype.create=function(){this.game.add.sprite(0,0,"menu-background");this.menuMusic_=this.game.add.audio("menu-background");this.menuMusic_.play("",0,1,true);this.buttonClick_=this.game.add.audio("select");this.clouds_.push(this.game.add.image(this.game.width/2+640/2,this.game.height,"smoke"));this.clouds_.push(this.game.add.image(-640,0,"smoke"));this.clouds_[0].anchor.setTo(.5,1);this.clouds_[0].scale.x=-1;this.game.add.tween(this.clouds_[0]).to({x:640/2},this.CLOUD_ANIMATION_SPEED*.62,Phaser.Easing.EaseInOut,true,0,-1,true);this.game.add.tween(this.clouds_[1]).to({x:0},this.CLOUD_ANIMATION_SPEED*.38,Phaser.Easing.EaseInOut,true,0,-1,true);this.add.button(this.game.world.centerX,this.game.world.centerY+200,"start-button",this.startGame_.bind(this),this,1,0,1,1).anchor.setTo(.5)};AAO.MainMenu.prototype.startGame_=function(){this.state.start("Game");this.menuMusic_.stop();this.buttonClick_.play()};AAO.GameDirector=function(e,t){this.game_=e.game;this.gameState_=e;this.player_=null;this.lastUpdate_=null;this.lastShot_=null;this.gunAmmo_=null;this.gunReloading_=false;this.entityGroup_=t;this.gameTimeText_=null;this.gameTimeTextGameOver_=null;this.sfx_=null;this.clipSprites_=[];this.zombieActivationChance=null;this.gameTime=null;this.zombiesKilled=0;this.bulletsFired=0;this.mobileZombiesGroup_=null;this.staticZombiesGroup_=null;this.deadZombiesGroup_=null;this.projectilesGroup_=null;this.UIGroup_=null;this.playerGroup_=null;this.TOTAL_GAME_TIME=1e3*60*3;this.ZOMBIE_INITIAL_STATIC_COUNT=50;this.ZOMBIE_STATIC_ANIMATION_SPEED=4;this.ZOMBIE_MOBILE_SPEED=.8;this.ZOMBIE_INITIAL_MOBILE_COUNT=25;this.ZOMBIE_MOBILE_ANIMATION_SPEED=6;this.ZOMBIE_MOBILE_ANIMATION_DYING_SPEED=6;this.ZOMBIE_INITIAL_MOBILE_SPAWN_RADIUS=350;this.ZOMBIE_BASE_ACTIVATION_CHANCE=2.5;this.GUN_BULLET_SPEED=1e3;this.GUN_COCK_SPEED=50;this.GUN_RELOAD_TIME=200;this.GUN_CLIP_SIZE=7;this.GUN_BULLET_POOL_SIZE=20;this.PLAYER_ANIMATION_SPEED=24};AAO.GameDirector.prototype.init=function(){this.lastUpdate_=(new Date).getTime();this.lastShot_=(new Date).getTime();this.gameTime=this.TOTAL_GAME_TIME;this.zombie_activation_chance=this.ZOMBIE_BASE_ACTIVATION_CHANCE;this.setupGroups_();this.addText_();this.addAudio_();this.addAmmo_();this.setupPhysics_();this.spawnPlayer_();this.spawnZombies_();this.setupTimer_()};AAO.GameDirector.prototype.addAmmo_=function(){this.gunAmmo_=this.GUN_CLIP_SIZE;var e=this.game_.cache.getImage("clip-sprite");var t=e.width/2;for(var n=0;n<this.GUN_CLIP_SIZE;n++){t+=50;var r=50;var i=this.game_.add.sprite(this.game_.width-t,r,"clip-sprite");i.animations.add("full",[0]);i.animations.add("empty",[1]);this.clipSprites_.push(i)}};AAO.GameDirector.prototype.addText_=function(){this.gameTimeText_=this.game_.add.bitmapText(45,50,"juice-regular","03:00",48)};AAO.GameDirector.prototype.addAudio_=function(){this.sfx_={};this.sfx_["gunshot"]=this.game_.add.audio("gunshot");this.sfx_["gunshot-empty"]=this.game_.add.audio("gunshot-empty");this.sfx_["gunshot-hit"]=this.game_.add.audio("gunshot-hit");this.sfx_["reload"]=this.game_.add.audio("reload");this.sfx_["zombie-groan"]=this.game_.add.audio("zombie-groan")};AAO.GameDirector.prototype.setupGroups_=function(){console.debug("GameDirector.setupGroups_()");this.mobileZombiesGroup_=this.game_.add.group();this.staticZombiesGroup_=this.game_.add.group();this.deadZombiesGroup_=this.game_.add.group();this.projectilesGroup_=this.game_.add.group();this.playerGroup_=this.game_.add.group();this.entityGroup_.add(this.deadZombiesGroup_);this.entityGroup_.add(this.mobileZombiesGroup_);this.entityGroup_.add(this.staticZombiesGroup_);this.entityGroup_.add(this.projectilesGroup_);this.entityGroup_.add(this.playerGroup_)};AAO.GameDirector.prototype.setupPhysics_=function(){console.debug("GameDirector.setupPhysics_()");this.projectilesGroup_.physicsBodyType=Phaser.Physics.ARCADE;this.projectilesGroup_.enableBody=true;this.playerGroup_.physicsBodyType=Phaser.Physics.ARCADE;this.playerGroup_.enableBody=true;this.projectilesGroup_.createMultiple(this.GUN_BULLET_POOL_SIZE,"bullet",0,false);this.projectilesGroup_.setAll("checkWorldBounds",true);this.projectilesGroup_.setAll("outOfBoundsKill",true)};AAO.GameDirector.prototype.setupTimer_=function(){this.timer_=this.game_.time.create(false);this.timer_.loop(1e3,this.updateTime_.bind(this),this);this.timer_.start()};AAO.GameDirector.prototype.spawnPlayer_=function(){this.player_=this.playerGroup_.create(this.game_.world.centerX,this.game_.world.centerY,"player");this.player_.animations.add("fire",[1,0]);this.player_.anchor.set(.5,.84);this.player_.body.immovable=true;this.player_.body.setSize(50,35,0,10);this.player_.scale.x=.75;this.player_.scale.y=.75};AAO.GameDirector.prototype.spawnZombies_=function(){console.debug("GameDirector.spawnZombies_()");this.spawnStaticZombies_();this.spawnMobileZombies_();this.activateZombie_(this.mobileZombiesGroup_.getAt(0))};AAO.GameDirector.prototype.spawnStaticZombies_=function(){for(var e=0;e<this.ZOMBIE_INITIAL_STATIC_COUNT;e++){var t=this.ZOMBIE_INITIAL_MOBILE_SPAWN_RADIUS*.8;var n=Math.random()*2*Math.PI;distX=Math.cos(n)*t;distY=Math.sin(n)*t;startX=this.game_.world.centerX+Math.cos(n)*(t+Math.random()*550);startY=this.game_.world.centerY+Math.sin(n)*(t+Math.random()*550);var r=this.game_.cache.getImage("zombie");if(startX-r.width/2>this.game_.width||startX+r.width/2<0||startY-r.height/2>this.game_.height||startY+r.height/2<0){continue}var i=this.staticZombiesGroup_.create(startX,startY,"zombie");var s=i.x-this.game_.world.centerX;var o=i.y-this.game_.world.centerY;var n=Math.atan2(o,s)*180/Math.PI-90;i.angle=n;i.anchor.set(.5);i.animations.add("walk",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);i.animations.play("walk",this.ZOMBIE_STATIC_ANIMATION_SPEED*(Math.random()+1),true)}};AAO.GameDirector.prototype.spawnMobileZombies_=function(){for(var e=0;e<this.ZOMBIE_INITIAL_MOBILE_COUNT;e++){this.spawnMobileZombie_()}};AAO.GameDirector.prototype.spawnMobileZombie_=function(){var e=this.ZOMBIE_INITIAL_MOBILE_SPAWN_RADIUS;var t=Math.random()*2*Math.PI;distX=Math.cos(t)*e;distY=Math.sin(t)*e;var n=this.mobileZombiesGroup_.create(this.game_.world.centerX+distX,this.game_.world.centerY+distY,"zombie");var r=n.x-this.game_.world.centerX;var i=n.y-this.game_.world.centerY;var t=Math.atan2(i,r)*180/Math.PI-90;n.angle=t;n.anchor.set(.5);n.animations.add("walk",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);n.animations.add("dying",[16,17,18,19,20,21,22,23]);n.animations.play("walk",this.ZOMBIE_MOBILE_ANIMATION_SPEED*(Math.random()+1),true);n.visible=true};AAO.GameDirector.prototype.render=function(){if(window.DEBUG){this.renderDebug_()}};AAO.GameDirector.prototype.renderDebug_=function(){var e=Math.round(this.gameTime/(60*1e3));var t=this.gameTime%(60*1e3)/1e3;this.game_.debug.text("time: "+e+":"+t,32,40);this.game_.debug.text("bullets: "+this.gunAmmo_,32,60);this.game_.debug.text("reloading: "+""+(this.gunReloading_?1:0),32,80);this.game_.debug.text("zombie kills: "+this.zombiesKilled,32,100);this.game_.debug.text("bullets shot: "+this.bulletsFired,32,120);this.game_.debug.body(this.player_);this.mobileZombiesGroup_.forEachAlive(function(e){this.game_.debug.body(e)}.bind(this));this.projectilesGroup_.forEachAlive(function(e){this.game_.debug.body(e)}.bind(this))};AAO.GameDirector.prototype.update=function(){console.debug("GameDirector.update()");this.updatePlayer_();this.updateZombies_();this.updateProjectiles_();this.updateCollisions_();this.lastUpdate_=(new Date).getTime()};AAO.GameDirector.prototype.updatePlayer_=function(){var e=this.game_.world.centerX-this.game_.input.x;var t=this.game_.world.centerY-this.game_.input.y;var n=Math.atan2(t,e)*180/Math.PI-90;this.player_.angle=n};AAO.GameDirector.prototype.updateTime_=function(){if(this.gameTime===0){this.pauseState_();this.gameState_.gameOver(true)}var e=Math.floor(this.gameTime/(60*1e3));var t=this.gameTime%(60*1e3)/1e3;this.gameTime-=1e3;this.gameTimeText_.text=(e<10?"0":"")+e+":"+("0"+t).slice(-2)};AAO.GameDirector.prototype.updateCollisions_=function(){this.game_.physics.arcade.collide(this.projectilesGroup_,this.mobileZombiesGroup_,this.projectileHitZombie_.bind(this),null,this);this.game_.physics.arcade.collide(this.player_,this.mobileZombiesGroup_,null,this.zombieHitPlayer_.bind(this),this)};AAO.GameDirector.prototype.updateZombies_=function(){this.mobileZombiesGroup_.forEachAlive(function(e){if(e.state!=="active"){return}var t=e.x-this.game_.world.centerX;var n=e.y-this.game_.world.centerY;var r=Math.atan2(n,t)*180/Math.PI-90;e.angle=r;var i=Math.cos(r);var s=Math.sin(r);e.x+=i*this.ZOMBIE_MOBILE_SPEED;e.y+=s*this.ZOMBIE_MOBILE_SPEED}.bind(this));var e=(new Date).getTime()-this.lastUpdate_;if(e/1e3*this.zombieActivationChance>Math.random()){this.activateZombie_()}this.zombieActivationChance=this.ZOMBIE_BASE_ACTIVATION_CHANCE+this.ZOMBIE_BASE_ACTIVATION_CHANCE/2*(1/(this.gameTime+1)*this.TOTAL_GAME_TIME-1)};AAO.GameDirector.prototype.activateZombie_=function(e){console.debug("GameDirector.activateZombie()");var t=false;this.mobileZombiesGroup_.forEachAlive(function(e){if(e.state!=="active"&&!t){e.animations.play("walk",this.ZOMBIE_MOBILE_ANIMATION_SPEED*(Math.random()+1),true);e.state="active";e.visible=true;t=true;this.game_.physics.enable(e,Phaser.Physics.ARCADE);e.enableBody=true;e.body.immovable=true;e.body.setSize(90,90,0,0)}}.bind(this))};AAO.GameDirector.prototype.updateProjectiles_=function(){if(this.game_.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&!this.gunReloading_){this.reloadGun_()}if(this.gunReloading_&&(new Date).getTime()-this.gunReloading_>this.GUN_RELOAD_TIME){this.gunAmmo_=this.GUN_CLIP_SIZE;this.gunReloading_=false;for(var e=0;e<this.clipSprites_.length;e++){this.clipSprites_[e].animations.play("full")}}if(this.game_.input.activePointer.isDown&&!this.gunReloading_&&(new Date).getTime()-this.lastShot_>this.GUN_COCK_SPEED&&this.lastShot_!==this.game_.input.activePointer.timeDown){if(this.gunAmmo_===0){this.sfx_["gunshot-empty"].play();return}var t=this.projectilesGroup_.getFirstDead();if(t===null)return;t.reset(this.game_.world.centerX,this.game_.world.centerY);t.anchor.set(.5);var n=t.x-this.game_.input.x;var r=t.y-this.game_.input.y;var i=Math.atan2(r,n)*180/Math.PI-90;t.angle=i;this.game_.physics.arcade.moveToXY(t,this.game_.input.x,this.game_.input.y,this.GUN_BULLET_SPEED);this.lastShot_=this.game_.input.activePointer.timeDown;this.player_.animations.play("fire",this.PLAYER_ANIMATION_SPEED);this.sfx_["gunshot"].play();this.clipSprites_[this.gunAmmo_-1].animations.play("empty");--this.gunAmmo_;++this.bulletsFired;if(window.ga){ga("send","event","game","bullet-fired")}}};AAO.GameDirector.prototype.reloadGun_=function(){this.gunReloading_=(new Date).getTime();this.sfx_["reload"].play()};AAO.GameDirector.prototype.projectileHitZombie_=function(e,t){t.animations.play("dying",this.ZOMBIE_MOBILE_ANIMATION_DYING_SPEED);t.angle+=Math.random()*200-10;t.body.destroy();t.cacheAsBitmap=true;this.mobileZombiesGroup_.removeChild(t);this.deadZombiesGroup_.addChild(t);e.kill();++this.zombiesKilled;this.spawnMobileZombie_();this.sfx_["gunshot-hit"].play();if(window.ga){ga("send","event","game","zombie-killed")}};AAO.GameDirector.prototype.zombieHitPlayer_=function(e,t){this.pauseState_();this.gameState_.gameOver(false)};AAO.GameDirector.prototype.pauseState_=function(){this.mobileZombiesGroup_.forEach(function(e){e.animations.currentAnim.paused=true});this.timer_.stop()};AAO.GameDirector.prototype.resumeState=function(){this.reloadGun_();this.gunAmmo_=this.GUN_CLIP_SIZE;this.gunReloading_=false;for(var e=0;e<this.clipSprites_.length;e++){this.clipSprites_[e].animations.play("full")}this.setupTimer_()};AAO.GameDirector.prototype.resetState=function(){this.projectilesGroup_.forEach(function(e){e.kill()});this.deadZombiesGroup_.removeAll();this.mobileZombiesGroup_.removeAll();this.spawnMobileZombies_();this.zombiesKilled=0;this.bulletsFired=0;this.gameTime=this.TOTAL_GAME_TIME;var e=Math.floor(this.gameTime/(60*1e3));var t=this.gameTime%(60*1e3)/1e3;this.gameTimeText_.text=(e<10?"0":"")+e+":"+("0"+t).slice(-2)};AAO.Game=function(e){console.debug("Game()");this.gameOver_=false;this.worldGroup_=null;this.sceneryGroup_=null;this.entityGroup_=null;this.gameDirector_=null;this.worldScale_=1;this.gameOverOverlay_=null;this.music_=null;this.sfx_=null;this.restartButton_=null;this.gameWonText_=null;this.gameStatsText_=null;this.retryCount_=0;this.GAME_OVER_ZOOM_LEVEL=5;this.GAME_OVER_ANIMATION_TIME=2539};AAO.Game.prototype.create=function(){console.debug("Game.create()");this.game.physics.startSystem(Phaser.Physics.ARCADE);this.sceneryGroup_=this.game.add.group();this.entityGroup_=this.game.add.group();this.gameDirector_=new AAO.GameDirector(this,this.entityGroup_);this.addSprites_();this.addAudio_();this.gameDirector_.init();this.addText_();this.addButtons_();this.game.onPause.add(this.managePause_,this);this.game.onResume.add(this.manageResume_,this);this.game.world.setBounds(-(this.game.width/2),-(this.game.height/2),this.game.width,this.game.height);this.game.world.pivot.x=this.game.width/2;this.game.world.pivot.y=this.game.height/2;if(window.ga){ga("send","event","game","game-started")}if(window.DEBUG){this.game.time.advancedTiming=true}};AAO.Game.prototype.update=function(){console.debug("Game.update()");if(this.gameOver_)return;this.updateOverlay_();this.gameDirector_.update()};AAO.Game.prototype.render=function(){this.gameDirector_.render();if(window.DEBUG){this.game.debug.text("fps: "+this.game.time.fps,32,20)}};AAO.Game.prototype.updateOverlay_=function(){console.debug("Game.updatePlayer_()");var e=this.game.world.centerX-this.game.input.x;var t=this.game.world.centerY-this.game.input.y;var n=Math.atan2(t,e)*180/Math.PI-90;this.darknessMask_.angle=n};AAO.Game.prototype.addText_=function(){this.gameTimeTextGameOver_=this.game.add.bitmapText(this.game.world.centerX,this.game.world.centerY,"juice-regular","5:00",120);this.gameTimeTextGameOver_.visible=false;this.gameWonText_=this.game.add.bitmapText(this.game.world.centerX,this.game.world.centerY,"juice-regular","RESCUE HAS ARRIVED!\n",48);this.gameWonText_.visible=false;this.gameStatsText_=this.game.add.bitmapText(this.game.world.centerX,this.game.world.centerY,"juice-regular","Zombies killed:396\nBullets fired:483\nAccuracy:64%",25);this.gameStatsText_.visible=false};AAO.Game.prototype.addButtons_=function(){this.restartButton_=this.add.button(this.game.world.centerX,this.game.world.centerY+200,"restart-button",function(){this.sfx_["button-click"].play();this.gameOverRestart_()}.bind(this),this,1,0,1,0);this.restartButton_.anchor.setTo(.5);this.restartButton_.visible=false};AAO.Game.prototype.addSprites_=function(){console.debug("Game.addSprites_()");this.sceneryGroup_.create(0,0,"background");var e=this.game.cache.getImage("darkness-alpha-mask");this.darknessOverlay_=this.game.make.bitmapData(e.width,e.height);this.darknessOverlay_.fill(5,9,5,1);this.darknessMask_=this.game.add.image(this.game.world.centerX,this.game.world.centerY,"darkness-alpha-mask");this.darknessMask_.anchor.set(.5);darknessSprite=this.game.add.image(this.game.world.centerX,this.game.world.centerY,this.darkness_).anchor.set(.5);this.game.add.image(0,0,"darkness");this.gameOverOverlay_=this.game.add.sprite(0,0,"game-over-overlay");this.gameOverOverlay_.visible=false};AAO.Game.prototype.addAudio_=function(){this.music_=this.game.add.audio("gameplay-background");this.music_.play("",0,1,true);this.sfx_={};this.sfx_["zombie-shuffle"]=this.game.add.audio("zombie-shuffle");this.sfx_["zombie-shuffle"].play("",0,1,true);this.sfx_["slow-down-to-halt"]=this.game.add.audio("slow-down-to-halt");this.sfx_["rewind"]=this.game.add.audio("rewind");this.sfx_["button-click"]=this.game.add.audio("select")};AAO.Game.prototype.managePause_=function(){console.debug("Game.managePause_()")};AAO.Game.prototype.manageResume_=function(){console.debug("Game.manageResume_()")};AAO.Game.prototype.reset_=function(){console.debug("Game.reset_()")};AAO.Game.prototype.gameOver=function(e){console.debug("Game.gameOver()");if(this.gameOver_)return;this.gameOver_=true;this.music_.pause("",0,1,true);filter=this.game.add.filter("Pixelate");this.entityGroup_.filters=[filter];var t=this.game.add.tween(this);t.onUpdateCallback(function(){this.game.world.scale.set(this.worldScale_)}.bind(this));t.onComplete.add(function(){if(!e){this.gameOverOverlay_.scale={x:1/this.worldScale_,y:1/this.worldScale_};this.gameOverOverlay_.x=this.game.world.centerX-this.gameOverOverlay_.width/2;this.gameOverOverlay_.y=this.game.world.centerY-this.gameOverOverlay_.height/2;this.gameOverOverlay_.visible=true;var n=Math.floor(this.gameDirector_.gameTime/(60*1e3));var r=this.gameDirector_.gameTime%(60*1e3)/1e3;this.gameTimeTextGameOver_.text=n+":"+("0"+(r+1)).slice(-2);this.gameTimeTextGameOver_.scale={x:1/this.worldScale_,y:1/this.worldScale_};this.gameTimeTextGameOver_.x=this.game.world.centerX-this.gameTimeTextGameOver_.width/2;this.gameTimeTextGameOver_.y=this.game.world.centerY-this.gameTimeTextGameOver_.height/2;this.gameTimeTextGameOver_.visible=true;if(window.ga){ga("send","event","game","game-over","",this.gameDirector_.gameTime)}}else{this.gameWonText_.scale={x:1/this.worldScale_,y:1/this.worldScale_};this.gameWonText_.x=this.game.world.centerX-this.gameWonText_.width/2;this.gameWonText_.y=this.game.world.centerY-this.gameWonText_.height*2;this.gameStatsText_.scale={x:1/this.worldScale_,y:1/this.worldScale_};if(this.gameDirector_.zombiesKilled===0){var i=0}else{var i=(100/this.gameDirector_.bulletsFired*this.gameDirector_.zombiesKilled).toFixed(2)}this.gameStatsText_.x=this.game.world.centerX-this.gameStatsText_.width/2;this.gameStatsText_.text="Zombies killed:"+this.gameDirector_.zombiesKilled+"\n"+"Bullets fired:"+this.gameDirector_.bulletsFired+"\n"+"Accuracy:"+i+"%";this.gameWonText_.visible=true;this.gameStatsText_.visible=true;if(window.ga){ga("send","event","game","game-completed","",i)}}this.restartButton_.scale={x:1/this.worldScale_,y:1/this.worldScale_};this.restartButton_.x=this.game.world.centerX;this.restartButton_.y=this.game.world.centerY+this.restartButton_.height*2;this.restartButton_.visible=true;t.stop()}.bind(this));t.to({worldScale_:this.GAME_OVER_ZOOM_LEVEL},this.GAME_OVER_ANIMATION_TIME,Phaser.Easing.Default,true);this.sfx_["slow-down-to-halt"].play()};AAO.Game.prototype.gameOverRestart_=function(){this.gameOverOverlay_.visible=false;this.gameTimeTextGameOver_.visible=false;this.restartButton_.visible=false;this.gameWonText_.visible=false;this.gameStatsText_.visible=false;this.restartButton_.destroy(true);this.restartButton_.game=this.game;this.addButtons_();this.gameDirector_.resetState();var e=this.game.add.tween(this);e.onUpdateCallback(function(){this.game.world.scale.set(this.worldScale_)}.bind(this));e.onComplete.add(function(){this.music_.play("",0,1,true);this.entityGroup_.filters=null;this.gameDirector_.resumeState();this.gameOver_=false}.bind(this),this);e.to({worldScale_:1},this.GAME_OVER_ANIMATION_TIME,Phaser.Easing.Default,true);this.sfx_["rewind"].play();if(window.ga){ga("send","event","game","game-retry","",++this.retryCount_)}};window.addEventListener("load",function(){window.DEBUG=window.location.href.indexOf("debug")!==-1;if(!window.DEBUG){console.debug=function(){};console.info=function(){}}console.debug=function(){};var e=new Phaser.Game({width:1280,height:720,renderer:Phaser.AUTO,parent:document.getElementById("game"),enableDebug:window.DEBUG});e.state.add("Boot",AAO.Boot);e.state.add("Preloader",AAO.Preloader);e.state.add("MainMenu",AAO.MainMenu);e.state.add("Game",AAO.Game);e.state.start("Boot")})